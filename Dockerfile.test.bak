# Use an official Python runtime as a parent image
FROM python:3.11-slim

# Set working directory
WORKDIR /app

# Install minimal FastAPI dependencies first
RUN pip install --no-cache-dir fastapi uvicorn google-cloud-firestore

# Copy only essential files to reduce build size
COPY src/api_test.py ./src/api_test.py

# Set environment variables
ENV PYTHONPATH=/app
ENV PYTHONUNBUFFERED=1
ENV PORT=8080
ENV HOST=0.0.0.0
ENV GOOGLE_CLOUD_PROJECT=legislativevideoreviewswithai

# Expose the port for Cloud Run
EXPOSE 8080

# Command to run when container starts
CMD ["python", "src/api_test.py"]